# EmbedDLL
<picture align="center">
  <source media="(prefers-color-scheme: dark)" srcset="https://github.com/Erzeng3l/Malware-Research/blob/main/Logo-dark.png">
  <source media="(prefers-color-scheme: light)" srcset="https://github.com/Erzeng3l/Malware-Research/blob/main/Logo-light.png">
  <img alt="logo" src="Logo-light.png" height="350">
</picture>

### Table of Contents
- [Table of Contents](#table-of-contents)
  - [Executive Summary](#executive-summary)
  - [High-Level Summary](#high-level-summary)
  - [Malware Compromise](#malware-compromise)
    - [embed.xml](#embedxml)
    - [embed.vbs](#embedvbs)
  - [Basic Static Analysis](#basic-static-analysis)
  - [Basic Dynamic Analysis](#basic-dynamic-analysis)
  - [Advanced Static Analysis](#advanced-static-analysis)
  - [Advanced Dynamic Analysis](#advanced-dynamic-analysis)
  - [Indicators of Compromise](#indicators-of-compromise)
    - [Network Indicators](#network-indicators)
    - [Host-based Indicators](#host-based-indicators)
  - [Rules \& Signatures](#rules--signatures)
  - [Appendices](#appendices)
    <ol type="A">
    <li>
    <a href="#a-yara-rules">
    <span class="title">YARA Rules</span>
    </a>
    </li>
    <li>
    <a href="#b-callback-urls">
    <span class="title">Callback URLs</span>
       </a>
    </li>
    <li>
    <a href="#c-decompiled-code-snippets">
    <span class="title">Decompiled Code Snippets</span>
       </a>
    </li>
    </ol>

### Executive Summary
<table>
  <tr>
  <td>SHA256</td><td>732F235784CD2A40C82847B4700FB73175221C6AE6C5F7200A3F43F209989387</td></td>
  </tr>
</table>

### High-Level Summary


### Malware Compromise
EmbedDLL is composed of a 64-bit script that sets up two payloads. The sample our team was able to recover was titled 'embed.xml' and 'embed.vbs,' which were then executed when interacting with the DLL.

<table>
  <tr><th>File Name</th><th>SHA256 Hash</th></tr>
  <tr><td>embed.xml</td><td>F1548CD02784606C8ABAC865ABF5ED6220D34EEA88C7A5715E0183D7F050F4AB</td></tr>
  <tr><td>embed.vbs</td><td>66FD543F31545082CF8FCC45A6AB1094BC118C45634F2BE450F84F4E5745B291</td></tr>
</table>

<p>EmbedDLL is a 64-bit dll file, runs C#</p>

#### embed.xml
![embed.xml](./Pics/embedxmlcompromise.png)

*Fig 1: Embed.xml*

#### embed.vbs
![embed.vba](./Pics/embedvbscompromise.png)

*Fig 2: Embed.vbs*

### Basic Static Analysis


### Basic Dynamic Analysis


### Advanced Static Analysis


### Advanced Dynamic Analysis


### Indicators of Compromise
A full set of IOCs can be found in the Appendix. 

#### Network Indicators

![Network](./Pics/networktraffic.png)

#### Host-based Indicators
A trademark of this infection is the 'embed.xml' and 'embed.vbs' file located in C:\\Users\\Public

![Embedxml](./Pics/embedxml.png)

<p>*Fig*</p>

![embedvbs](./Pics/embedvbs.png)

<p>*fig*</p>

### Rules & Signatures
A full set of YARA rules is included in Appendix A.

### Appendices

#### A. Yara Rules
```yara
rule Yara_example {

    meta:
        last_updated = "2023-10-06"
        author = "3rzeng3l"
        description = ""

    strings:
        //Fill out identifying strings and other criteria
        $string1 = "EmbedDLL"
    ascii
        $string2 = "mscoree.dll"
        $string3 = "p0w3r0verwh3lm1ng!"
        $PE_magic_byte = "MZ"
        $sus_hex_string = "2eab5b3e-db27-4823-8690-150bb182b16b"
    condition:
        // Fill out the conditions that must be met to identify the binary
        $PE_magic_byte at 0 and
        ($string1 and $string2 and $string3) or
        
        $sus_hex_string

}
```
#### B. Callback URLs
<table>
  <tr><th>Domain</th><th>Port</th></tr>
  <tr><td>src[.]masterchiefsgruntemporium[.]local</td><td>53</td></tr>
</table>

#### C. Decompiled Code Snippets


